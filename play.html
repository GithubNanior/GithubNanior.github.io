<!DOCTYPE html>
<html lang="en-us">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#111827">
        <meta name="description" content="P-Practite? Practisite? Practice site?">
        <link rel="stylesheet" href="css/style.css">
        <script type="text/javascript" src="https://static.itch.io/api.js"></script>
        <script type="text/javascript" src="js/itchUtil.js"></script>
        <script type="text/javascript">
            let gameName = new URLSearchParams(window.location.search).get("game")

            let gameData = null
            let gameContainer = null

            //I didn't find any better way to write this, I'm requesting data in parallel, and the latest to complete will be the one to put things together
            getGameData(gameName).then((data)=>{
                gameData = data
                if (gameContainer != null)
                {
                    CreateIframe()
                }
            })

            window.onload = function() {
                gameContainer = document.getElementById("game-container")
                if (gameData != null)
                {
                    CreateIframe()
                }
            }

            function CreateIframe()
            {
                gameContainer.innerHTML = `
                    <iframe frameborder="0" src="https://itch.io/embed-upload/${gameData["embedId"]}?color=000000" allowfullscreen="" width="975" height="675">
                        <a href="https://danior.itch.io/${gameName}">Play on itch.io</a>
                    </iframe>
                `
            }
        </script>
        <title>Nanior's Attic</title>
    </head>
    <body>
        <header>
            <nav class="topbar">
                <img src="images/logo.png" alt="logo">
                <a href="index.html">Home</a>
                <a href="games.html">Games</a>
            </nav>
        </header>
        <content>
            <section>
                <h2 id="game-title">Game title</h2>
                <hr>
                <div class="flex-center" id="game-container">
                    
                </div>
            </section>
        </content>
    </body>
</html>